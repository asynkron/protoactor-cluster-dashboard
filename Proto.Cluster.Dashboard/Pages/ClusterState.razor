@page "/clusterstate"
@using Proto.Cluster.Gossip
@inject ActorSystem System
<PageTitle>Counter</PageTitle>

<MudGrid Spacing="6">
    <MudItem xs="5">
        <MemberSearch OnMemberSelected="MemberSelected" OnGossipState="GossipState"></MemberSearch>
    </MudItem>
    <MudItem xs="7">
        
        @if (_state != null && _member != null)
        {
            var memberState = _state.Members[_member.Id];
            
            <MudText Color="Color.Default" Typo="Typo.h5"><MudIcon Size="Size.Large" Icon="@Icons.TwoTone.GroupWork" /> Member @_member.Id</MudText>
            <MudCard Class="my-2" Outlined="true">
                <MudCardContent>
                    <MemberStateWidget MemberId="@_member.Id" State="@memberState"></MemberStateWidget>
                </MudCardContent>
            </MudCard>
            
        }
    </MudItem>
</MudGrid>

@code {
    private Member? _member;
    private GossipState? _state;

    private Task MemberSelected(Member member)
    {
        _member = member;
        return Task.CompletedTask;
    }

    private Task GossipState(GossipState gossipState)
    {
        _state = gossipState;
        return Task.CompletedTask;
    }
}